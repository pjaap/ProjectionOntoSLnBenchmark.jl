module PlotSlowConvergenceOfCS

    using Plots
    using LaTeXStrings
    using DrWatson: projectdir

    function main()

        a = [0.3, 0.0]

        # resulting CS iterations
        pk_matrix = [1.1500000000000012 0.8695652173913033; 1.1500000000000012 0.8695652173913033; 1.0324078776266257 0.9686094181612145; 1.1301551991249694 0.8848342284925734; 1.0474584164538616 0.9546918375029141; 1.1164039023276213 0.8957331623946488; 1.0582058676986104 0.9449957029652624; 1.1068264643494126 0.9034840011547194; 1.0658511519259073 0.9382173028196394; 1.100132469004876 0.9089814387553581; 1.071274800151749 0.9334673008659214; 1.0954423303415857 0.912873244385151; 1.0751148927874317 0.9301331479042567; 1.0921505599822026 0.9156246783438307; 1.0778300201113944 0.9277900783235822; 1.0898374458899907 0.9175680254380049; 1.0797478587847815 0.9261421401977697; 1.0882106772222575 0.9189397113711905; 1.0811015964078328 0.9249824408371982; 1.0870659083166105 0.9199074192036811; 1.0820566859182277 0.9241660018012542; 1.0862600074984277 0.9205899116885635; 1.082730281349177 0.923591047970601; 1.0856924831374744 0.921071122539128; 1.0832052359772082 0.9231860783022694; 1.0852927537248875 0.9214103663413825; 1.0835400754383555 0.9229008020637317; 1.0850111676119099 0.9216494967521137; 1.0837760950060145 0.9226998104871788; 1.0848127817885285 0.9218180412419165; 1.0839424503579655 0.9225581972654817; 1.0846730060660086 0.9219368311354158; 1.0840597039852358 0.9224584237615462; 1.0845745194642538 0.922020547935976; 1.084142332832146 0.9223881135044496; 1.0845051286692506 0.9220795539991111; 1.0842005638070318 0.9223385657620425; 1.0844562250603584 0.9221211310726023; 1.0842416091408964 0.9223036609029148; 1.0844217663938596 0.9221504308108236; 1.0842705279241072 0.9222790586068472; 1.0843974847628073 0.9221710793160975; 1.0842909061580661 0.9222617202340447; 1.0843803721174259 0.9221856288689638; 1.0843052687473806 0.9222495043877877; 1.0843683194473595 0.9221958888228191; 1.0843153947732531 0.9222409000679986; 1.0843598195374413 0.9222031112514201; 1.0843225252875794 0.9222348326562105; 1.0843538301670916 0.9222082009157981; 1.0843275514207165 0.9222305588304824]
        pp = plot(size = (500, 300), xlims=(1,1.2), ylims=xlims=(0.85,1.05), legend=:bottomleft)

        # plot sl(n)
        xx = 0.25:0.01:4.0
        plot!(pp, xx, 1 ./ xx, linewidth = 3, label = L"\operatorname{sl}(2)")

        plot!(pp, pk_matrix[:, 1], pk_matrix[:, 2], mark = :circle, markersize=2, label = "composite step iterates")

        lens!(pp, [1.0825, 1.086], [0.92, 0.925], inset = (1, bbox(0.5, 0.00, 0.4, 0.55)))

        # p‚Å∞
        scatter!(pp, [pk_matrix[1,1]],[pk_matrix[1,2]], mark = :circle, markersize=4, label = L"initial iterate $p^0$")

        return savefig(pp, projectdir("gfx", "cs_slow_convergence.pdf"))

    end

end # module

PlotSlowConvergenceOfCS.main()
